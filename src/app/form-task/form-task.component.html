<form [formGroup]="userform" (ngSubmit)="isEditing ? updateRecord() : onSubmit()" class="form-container">
  <div class="form-group">
    <label>Company Name:</label>
    <input type="text" formControlName="companyName" placeholder="Enter Company Name" />
    @if(userform.get('companyName')?.invalid && userform.get('companyName')?.touched){
    <small>
      Company name is required (Min 3 characters)
    </small>
  }
  </div>

  <div formGroupName="address" class="form-group">
    <label>Country:</label>
    <input type="text" formControlName="country" placeholder="Enter Country" />
    @if(userform.get('address.country')?.invalid && userform.get('address.country')?.touched){
    <small>
      Country is required (Min 3 characters)
    </small>
  }
    <label>Street:</label>
    <input type="text" formControlName="street" placeholder="Enter Street" />

    <label>City:</label>
    <input type="text" formControlName="city" placeholder="Enter City" />

    <label>Zip:</label>
    <input type="number" formControlName="zip" placeholder="Enter Zip Code" min="0"/>
  </div>

  <div formArrayName="units" class="units-container">
    <h2>Units</h2>
    @for(unit of units.controls; track unit ; let i = $index){
    <div [formGroupName]="i" class="unit-group">
      <label>Unit Name:</label>
      <input formControlName="unitName" type="text" />

      <label>Quantity:</label>
      <input formControlName="quantity" type="number" (input)="updateTotalSum(i)" min="0" />

      <label>Unit Price:</label>
      <input formControlName="unitPrice" type="number" (input)="updateTotalSum(i)" min="0"/>

      <label>Total Sum:</label>
      <input formControlName="totalSum" type="number" readonly />

      <button type="button" (click)="deleteUnit(i)">Remove</button>
    </div>
    }
    <button class="add-unit-button" type="button" (click)="addUnits()">+ Add new unit</button>
  </div>

  <div class="submitbutton">
    <button class="submit-button" type="submit" *ngIf="!isEditing">Submit</button>
    <button class="submit-button" type="submit" *ngIf="isEditing">Update</button>
  </div>
</form>

